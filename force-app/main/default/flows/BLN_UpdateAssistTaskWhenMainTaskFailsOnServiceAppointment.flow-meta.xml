<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <description>Fail assist tasks when main task fails for FAA</description>
        <name>Error_Handling_for_FAA</name>
        <label>Error Handling for FAA</label>
        <locationX>1220</locationX>
        <locationY>1422</locationY>
        <actionName>BLN_FlowExceptionLogger</actionName>
        <actionType>apex</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>excmessage</name>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputParameters>
        <nameSegment>BLN_FlowExceptionLogger</nameSegment>
    </actionCalls>
    <actionCalls>
        <description>Fail assist tasks when main task fails for FBA</description>
        <name>Error_Handling_for_FBA</name>
        <label>Error Handling for FBA</label>
        <locationX>330</locationX>
        <locationY>1450</locationY>
        <actionName>BLN_FlowExceptionLogger</actionName>
        <actionType>apex</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>excmessage</name>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputParameters>
        <nameSegment>BLN_FlowExceptionLogger</nameSegment>
    </actionCalls>
    <apiVersion>54.0</apiVersion>
    <assignments>
        <name>Assign_Collection_Variable_for_FAA</name>
        <label>Assign Collection Variable for FAA</label>
        <locationX>536</locationX>
        <locationY>1093</locationY>
        <assignmentItems>
            <assignToReference>BLN_CollectionForFBA</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>LooponFBA</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>LooponFBA</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Collection_Variable_for_FBA</name>
        <label>Assign Collection Variable for FBA</label>
        <locationX>222</locationX>
        <locationY>1136</locationY>
        <assignmentItems>
            <assignToReference>BLN_CollectionForFBA</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>LooponFBA</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>LooponFBA</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Current_Records_for_FAA</name>
        <label>Assign Current Records for FAA</label>
        <locationX>1038</locationX>
        <locationY>1144</locationY>
        <assignmentItems>
            <assignToReference>BLN_CollectionVariable</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loopon_FAA_records</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loopon_FAA_records</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Current_Records_For_FBA</name>
        <label>Assign Current Records For FBA</label>
        <locationX>1329</locationX>
        <locationY>1019</locationY>
        <assignmentItems>
            <assignToReference>BLN_CollectionVariable</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loopon_FAA_records</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loopon_FAA_records</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_FAA</name>
        <label>Assign FAA</label>
        <locationX>1065</locationX>
        <locationY>911</locationY>
        <assignmentItems>
            <assignToReference>Loopon_FAA_records.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Failed After Arrive</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Loopon_FAA_records.BLN_FailureReason__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.BLN_FailureReason__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Loopon_FAA_records.BLN_SubFailureReason__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.BLN_SubFailureReason__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Loopon_FAA_records.ActualEndTime</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.ActualEndTime</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Current_Records_for_FAA</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_FBA</name>
        <label>Assign FBA</label>
        <locationX>1689</locationX>
        <locationY>1023</locationY>
        <assignmentItems>
            <assignToReference>Loopon_FAA_records.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Failed Before Arrive</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Loopon_FAA_records.BLN_FailureReason__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.BLN_FailureReason__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Loopon_FAA_records.BLN_SubFailureReason__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.BLN_SubFailureReason__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Current_Records_For_FBA</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assigning_Status_FAA</name>
        <label>Assigning Status FAA</label>
        <locationX>784</locationX>
        <locationY>1050</locationY>
        <assignmentItems>
            <assignToReference>LooponFBA.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Failed After Arrive</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>LooponFBA.BLN_FailureReason__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.BLN_FailureReason__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>LooponFBA.BLN_SubFailureReason__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.BLN_SubFailureReason__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>LooponFBA.ActualEndTime</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Collection_Variable_for_FAA</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assigning_Status_FBA</name>
        <label>Assigning Status FBA</label>
        <locationX>349</locationX>
        <locationY>917</locationY>
        <assignmentItems>
            <assignToReference>LooponFBA.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Failed Before Arrive</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>LooponFBA.BLN_FailureReason__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.BLN_FailureReason__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>LooponFBA.BLN_SubFailureReason__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.BLN_SubFailureReason__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Collection_Variable_for_FBA</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Failed_appointment</name>
        <label>Failed appointment</label>
        <locationX>551</locationX>
        <locationY>460</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Main_task_failed_before_arrive</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.BLN_WorkOrderLineItem__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Failed Before Arrive</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.WorkType.BLN_IsMainJob__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Related_assist_records</targetReference>
            </connector>
            <label>Main task failed Before Arrive</label>
        </rules>
        <rules>
            <name>Main_task_failed_after_arrive</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.BLN_WorkOrderLineItem__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.WorkType.BLN_IsMainJob__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Failed After Arrive</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_FAA_records</targetReference>
            </connector>
            <label>Main task failed after arrive</label>
        </rules>
    </decisions>
    <decisions>
        <name>No_record_For_FAA</name>
        <label>No record For FAA</label>
        <locationX>1234</locationX>
        <locationY>585</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>No_assist_record_for_FAA</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_FAA_records</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loopon_FAA_records</targetReference>
            </connector>
            <label>No assist record for FAA</label>
        </rules>
    </decisions>
    <decisions>
        <name>No_Record_found_for_Assist_record_FBA</name>
        <label>No Record found for Assist record FBA</label>
        <locationX>50</locationX>
        <locationY>652</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>No_FBA_Assist_Record</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Related_assist_records</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>LooponFBA</targetReference>
            </connector>
            <label>No FBA Assist Record</label>
        </rules>
    </decisions>
    <decisions>
        <name>Status_For_FAA_and_FBA</name>
        <label>Status For FAA and FBA</label>
        <locationX>1671</locationX>
        <locationY>699</locationY>
        <defaultConnector>
            <targetReference>Loopon_FAA_records</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Assign_Status_FAA</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>Loopon_FAA_records.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>In Progress</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Loopon_FAA_records.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Arrived</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_FAA</targetReference>
            </connector>
            <label>Assign Status FAA</label>
        </rules>
        <rules>
            <name>Assign_Status_FBA</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>Loopon_FAA_records.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>None</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Loopon_FAA_records.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Pending</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Loopon_FAA_records.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Scheduled</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Loopon_FAA_records.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Dispatched</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Loopon_FAA_records.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Travel</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_FBA</targetReference>
            </connector>
            <label>Assign Status FBA</label>
        </rules>
    </decisions>
    <decisions>
        <name>Status_For_FBA_and_FAA</name>
        <label>Status For FBA and FAA</label>
        <locationX>751</locationX>
        <locationY>688</locationY>
        <defaultConnector>
            <targetReference>LooponFBA</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Assigning_Status_for_FBA</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>LooponFBA.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>None</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>LooponFBA.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Pending</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>LooponFBA.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Scheduled</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>LooponFBA.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Dispatched</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>LooponFBA.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Travel</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assigning_Status_FBA</targetReference>
            </connector>
            <label>Assigning Status for FBA</label>
        </rules>
        <rules>
            <name>Assigning_Status_for_FAA</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>LooponFBA.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>In Progress</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>LooponFBA.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Arrived</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assigning_Status_FAA</targetReference>
            </connector>
            <label>Assigning Status for FAA</label>
        </rules>
    </decisions>
    <description>FOUK-156---&gt; This flow is for Fail the assist task when main task is failed.</description>
    <environments>Default</environments>
    <formulas>
        <name>CurrentUserId</name>
        <dataType>String</dataType>
        <expression>{!$User.Id}</expression>
    </formulas>
    <interviewLabel>Update Assist Task When Main Task Fails On Service Appointment {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Update Assist Task When Main Task Fails On Service Appointment</label>
    <loops>
        <name>Loopon_FAA_records</name>
        <label>Loopon FAA records</label>
        <locationX>977</locationX>
        <locationY>695</locationY>
        <collectionReference>Get_FAA_records</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Status_For_FAA_and_FBA</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_FAA_records</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>LooponFBA</name>
        <label>LooponFBA</label>
        <locationX>97</locationX>
        <locationY>695</locationY>
        <collectionReference>Get_Related_assist_records</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Status_For_FBA_and_FAA</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_FBA_records</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Error_Exception_logs_for_FAA</name>
        <label>Error Exception logs for FAA</label>
        <locationX>944</locationX>
        <locationY>1430</locationY>
        <faultConnector>
            <targetReference>Error_Handling_for_FAA</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>BLN_CurrentUser__c</field>
            <value>
                <elementReference>CurrentUserId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>BLN_EntityName__c</field>
            <value>
                <stringValue>BLN_UpdateAssistTaskWhenMainTaskFailsOnServiceAppointment</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>BLN_ErrorMessage__c</field>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>BLN_LogType__c</field>
            <value>
                <stringValue>Exception</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>BLN_MethodStep__c</field>
            <value>
                <elementReference>Update_FAA_records</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>BLN_RecordIdIdentifier__c</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <object>BLN_FlowException__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Error_Exception_logs_for_FBA</name>
        <label>Error Exception logs for FBA</label>
        <locationX>83</locationX>
        <locationY>1450</locationY>
        <faultConnector>
            <targetReference>Error_Handling_for_FBA</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>BLN_CurrentUser__c</field>
            <value>
                <elementReference>CurrentUserId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>BLN_EntityName__c</field>
            <value>
                <stringValue>BLN_UpdateAssistTaskWhenMainTaskFailsOnServiceAppointment</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>BLN_ErrorMessage__c</field>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>BLN_LogType__c</field>
            <value>
                <stringValue>Exception</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>BLN_MethodStep__c</field>
            <value>
                <elementReference>Update_FBA_records</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>BLN_RecordIdIdentifier__c</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <object>BLN_FlowException__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Get_FAA_records</name>
        <label>Get FAA records</label>
        <locationX>981</locationX>
        <locationY>528</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>No_record_For_FAA</targetReference>
        </connector>
        <filterLogic>1 AND 2 AND (3 OR 4)</filterLogic>
        <filters>
            <field>BLN_WorkOrderNumber__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.BLN_WorkOrderNumber__r.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>WorkTypeId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>AssistId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Arrived</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>In Progress</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>ServiceAppointment</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Related_assist_records</name>
        <label>Get Related assist records</label>
        <locationX>97</locationX>
        <locationY>587</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>No_Record_found_for_Assist_record_FBA</targetReference>
        </connector>
        <filterLogic>1 AND 2 AND (3 OR 4)</filterLogic>
        <filters>
            <field>BLN_WorkOrderNumber__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.BLN_WorkOrderNumber__r.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>WorkTypeId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>AssistId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Dispatched</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Travel</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>ServiceAppointment</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Worktype</name>
        <label>Get Worktype</label>
        <locationX>561</locationX>
        <locationY>339</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Failed_appointment</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Assist</stringValue>
            </value>
        </filters>
        <object>WorkType</object>
        <outputAssignments>
            <assignToReference>AssistId</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordUpdates>
        <name>Update_FAA_records</name>
        <label>Update FAA records</label>
        <locationX>935</locationX>
        <locationY>1213</locationY>
        <faultConnector>
            <targetReference>Error_Exception_logs_for_FAA</targetReference>
        </faultConnector>
        <inputReference>BLN_CollectionVariable</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_FBA_records</name>
        <label>Update FBA records</label>
        <locationX>83</locationX>
        <locationY>1224</locationY>
        <faultConnector>
            <targetReference>Error_Exception_logs_for_FBA</targetReference>
        </faultConnector>
        <inputReference>BLN_CollectionForFBA</inputReference>
    </recordUpdates>
    <start>
        <locationX>431</locationX>
        <locationY>15</locationY>
        <connector>
            <targetReference>Get_Worktype</targetReference>
        </connector>
        <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
        <filterFormula>({!$Permission.BLN_BypassFlows} = False) &amp;&amp;
OR(ISPICKVAL({!$Record.Status}, &apos;Failed After Arrive&apos;), ISPICKVAL({!$Record.Status}, &apos;Failed Before Arrive&apos;))</filterFormula>
        <object>ServiceAppointment</object>
        <recordTriggerType>Update</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <triggerOrder>70</triggerOrder>
    <variables>
        <name>AssistId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>BLN_CollectionForFBA</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ServiceAppointment</objectType>
    </variables>
    <variables>
        <name>BLN_CollectionVariable</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ServiceAppointment</objectType>
    </variables>
    <variables>
        <name>FBARecords</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
